<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <script type="text/javascript">
    !function(T,l,y){var S=T.location,u="script",k="instrumentationKey",D="ingestionendpoint",C="disableExceptionTracking",E="ai.device.",I="toLowerCase",b="crossOrigin",w="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"4",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[I](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:e,name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,p,l,u;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][I]()]=i[1])}if(!e[D]){var r=e.endpointsuffix,o=r?e.location:null;e[D]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[k]||d[k]||"",p=s[D],l=p?p+"/v2/track":config.endpointUrl,(u=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=l,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\./g,"-"),hasFullStack:!1,stack:n+"\nSnippet failed to load ["+a+"] -- Telemetry is disabled\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\nHost: "+(S&&S.pathname||"_unknown_")+"\nEndpoint: "+i,parsedStack:[]}],r)),u.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,l)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:w,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(w,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(u,l))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(u);n.src=h;var e=y[b];return!e&&""!==e||"undefined"==n[b]||(n[b]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(u)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[C]&&!0!==s[C]){method="onerror",t(["_"+method]);var c=T[method];T[method]=function(e,t,n,a,i){var r=c&&c(e,t,n,a,i);return!0!==r&&m["_"+method]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);(T[t]=n).queue&&0===n.queue.length&&n.trackPageView({})}(window,document,{
    src: "https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",
    cfg: {
        instrumentationKey: "b0b411e6-3e51-4578-b762-608bb183d4a6"
    }});
    var telemetryInitializer = (envelope) => {
      envelope.data.someField = 'This item passed through my telemetry initializer';
    };
    appInsights.addTelemetryInitializer(telemetryInitializer);
    appInsights.trackTrace({message: 'This message will use a telemetry initializer'});
    var id = null;
    fetch('/.auth/me').then(function(response){
      return response.json();
    }).then(function(data){
      id = data[0].user_id;
      appInsights.setAuthenticatedUserContext(id);
    });
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Module 3 - Static Code Analysis | DevOps Dojo </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Module 3 - Static Code Analysis | DevOps Dojo ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../../../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../../../toc.html">
  
  
  
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../../../../index.html">
                <div class="msft-logo"></div>
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p><strong><a href="../index.html">Home</a> | <a href="module1.html">Module 1</a> | <a href="module2.html">Module 2</a> | <a href="module3.html">Module 3</a> | <a href="module4.html">Module 4</a> |</strong></p>
<h1 id="module-3---static-code-analysis"><strong>Module 3 - Static Code Analysis</strong></h1>
<hr>
<p>Static Code Analysis ensures that the application code in the repository will always meet certain level of compliance and security requirements. GitHub provides many static code analysis tools which can be used out of the box.
This module will provide an understanding of various static analysis tools that can be used in GitHub.</p>
<h2 id="exercise-1-github-advanced-security-code--secret-scanning">Exercise 1: GitHub Advanced Security: Code &amp; Secret Scanning</h2>
<hr>
<p>To complete this exercise, you will enable <a href="https://docs.github.com/en/github/getting-started-with-github/about-github-advanced-security">GitHub Advanced Security</a> features and integrate <a href="https://codeql.github.com/docs/">CodeQL</a> for the bookings application.</p>
<h3 id="prerequisites---exercise-1">Prerequisites - Exercise 1</h3>
<hr>
<ul>
<li>CI Module 2 must be completed and the same branch created in module 1 is supposed to be used in this module.</li>
<li>GitHub Advanced Security has been enabled for your repository.</li>
<li>You should have Admin access to the repository.</li>
</ul>
<hr>
<ol>
<li><p>Before starting, in your GitHub repository switch the branch from main to the branch you created in CI Module 1.</p>
</li>
<li><p>Firstly, we will enable static code analysis settings in the GitHub Repository. Go to <code>Settings &gt; Security &amp; Analysis</code>. Enable GitHub Advanced Security, Secret Scanning, Dependency graph and Dependabot alerts.</p>
<p><img src="../../media/enable_static_analysis.gif" alt="Enable github advanced security settings"></p>
</li>
<li><p>Now, lets configure one of code scanning tools: CodeQL. Select <code>Go to code scanning &gt; Set up more code scanning tools</code>. Find <strong>CodeQL Analysis</strong> and select <strong>Set up this workflow</strong>. We won't need to update any configurations as the predefined settings are already pointing to the csharp and javascript languages.</p>
<pre><code class="lang-yaml">strategy:
  fail-fast: false
  matrix:
    language: [ 'csharp', 'javascript' ]
</code></pre>
<p>However, we will be editing the <code>on</code> section and adding the <code>workflow_dispatch</code> option. This section should look like this:</p>
<pre><code class="lang-yaml">on:
    push:
        branches: [ main ]
    pull_request:
        # The branches below must be a subset of the branches above
        branches: [ main ]
    schedule:
        - cron: '19 2 * * 1'
    workflow_dispatch:
        branches: [ main, users/** ]
</code></pre>
<p><img src="../../media/codeql_setup_bookings2.gif" alt="CodeQL Setup"></p>
</li>
<li><p>Now that we have enabled CodeQL &amp; Secret scanning, lets see where exactly are the alerts visible. These alerts are visible under the <strong>Security</strong> tab in GitHub. CodeQL alerts will appear under Code scanning alerts and any exposed secrets are notified via email as well as listed over here.</p>
<p><img src="../../media/codeql_example_1.png" alt="List of CodeQl errors"></p>
<p><img src="../../media/codeql_example_2.png" alt="CodeQl error details"></p>
<p><img src="../../media/github_secret_scanning_example.png" alt="Secret Scan email notification"></p>
</li>
<li><p>In the CodeQL errors you will mainly find these 4 sections:</p>
<ul>
<li>Error highlighted code</li>
<li>Recommendations to fix the error</li>
<li>Example of error fix</li>
<li>References to understand error</li>
</ul>
</li>
</ol>
<h2 id="exercise-2-github-advanced-security-dependency-graph--dependabot-alerts">Exercise 2: GitHub Advanced Security: Dependency Graph &amp; Dependabot alerts</h2>
<hr>
<p>To complete this exercise, you will analyze the dependency graph for bookings application, and understand how dependabot alerts can be utilized to keep the dependencies used in the application up to date.</p>
<h3 id="prerequisites---exercise-2">Prerequisites - Exercise 2</h3>
<hr>
<ul>
<li>CI Module 3 - Exercise 1 must be completed.</li>
<li>GitHub Advanced Security has been enabled for your repository.</li>
<li>You should have Admin access to the repository.</li>
</ul>
<hr>
<ol>
<li><p><strong>Dependency graph</strong> is a great tool to have a collated view of all dependencies used by the application. This can be found at <code>Insights &gt; Dependency Graph</code>.</p>
</li>
<li><p>With <strong>Dependabot alerts</strong>, you can recognize deprecated dependencies which may have security flaws, which the hackers utilize to get into the system. Thus using dependabot alerts, such dependencies can be easily identified and updated.</p>
<p><img src="../../media/dependency_graph_bookings.gif" alt="Dependency graph and dependabot alerts"></p>
</li>
<li><p>Each dependabot alert, has 2 main sections:</p>
<ul>
<li>Remediation</li>
<li>Details related to security flaws</li>
</ul>
<p><img src="../../media/dependabot_alert_bookings.png" alt="Details of dependabot alert"></p>
</li>
<li><p>If you think the remediation mentioned is good enough and you want to go with it, you can go ahead and directly fix it in your application by selecting <strong>Create Dependabot security update</strong>. This will take about 2 minutes, after which a dependabot will automatically create a PR to merge with master. Verify the PR once, and once you are 100% sure, go ahead and merge it with main. If you can't see the PR, please refresh.</p>
<p><img src="../../media/dependabot_alert_PR_bookings.gif" alt="Dependabot automatic PR"></p>
</li>
</ol>
<h1 id="key-takeaways"><strong>Key Takeaways</strong></h1>
<hr>
<ul>
<li>GitHub Advanced Security helps ensure application code follows appropriate standards and has latest security updates.</li>
<li>With secret scanning, we can prevent secrets from being exposed via application code.</li>
<li>Automatic dependabot alerts and security updates ensure application dependencies are always updated to latest version.</li>
</ul>
<hr>
<h2 id="whats-next-">What's Next ?</h2>
<hr>
<p><a href="module4.html">Module 4 - Branch Policies</a></p>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      <footer class="w-100 py-2">
          <div class="container my-2">
              <div class="hacker white"></div>
              <div class="hacker orange"></div>
              <div class="hacker green"></div>
              <div class="hacker black"></div>
              <div class="dojo-teams hidden-xs hidden-sm"></div>
          </div>
      </footer>    </div>

    <script type="text/javascript" src="../../../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../../../styles/main.js"></script>
  </body>
</html>
